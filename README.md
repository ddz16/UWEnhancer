This is the preliminary code without good comments or organization. I will provide a well-organized and detailed commented version after the paper is accepted.
